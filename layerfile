FROM alpine
RUN apk update \
 && apk add --no-cache curl \
 apk add openrc \
 apk add gcc linux-headers libev-dev \
 apk add caddy \
 apk add musl-dev \
 apk add python3-dev
RUN python -m ensurepip --upgrade
 apk add doas; \
 adduser zer0 -G wheel; \
 echo 'zer0:123' | chpasswd; \
 echo 'permit :wheel as root' > /etc/doas.d/doas.conf
 echo 'permit nopass :wheel as root' >> /etc/doas.d/doas.conf
 echo 'permit persist :wheel as root' >> /etc/doas.d/doas.conf
USER zer0
RUN pip3 install circus
EXPOSE WEBSITE http://localhost:80
